# Δημόσιο κλειδί
N = 11413
e = 19

# Παραγοντοποίηση N = p * q
p = 113
q = 101

# Υπολογισμός φ(N)
phi_N = (p - 1) * (q - 1)

# Εκτεταμένος Ευκλείδειος Αλγόριθμος για τον υπολογισμό του d (αντίστροφο του e mod φ(N))
def extended_gcd(a, b):
    if a == 0:
        return b, 0, 1
    gcd, x1, y1 = extended_gcd(b % a, a)
    x = y1 - (b // a) * x1
    y = x1
    return gcd, x, y

# Υπολογισμός του d
_, d, _ = extended_gcd(e, phi_N)
d = d % phi_N  # Βεβαιωνόμαστε ότι το d είναι θετικό

print(f"Ιδιωτικό κλειδί: (N, d) = ({N}, {d})")

# Κρυπτογραφημένο μήνυμα
C = [3203, 909, 3143, 5255, 5343, 3203, 909, 9958, 5278, 5343, 9958,
     5278, 4674, 909, 9958, 792, 909, 4132, 3143, 9958, 3203, 5343, 792, 3143, 4443]

# Αποκρυπτογράφηση: m_i = c_i^d mod N, έπειτα μετατροπή σε χαρακτήρα ASCII
decrypted_message = ''.join([chr(pow(c, d, N)) for c in C])

print("Αποκρυπτογραφημένο μήνυμα:")
print(decrypted_message)
