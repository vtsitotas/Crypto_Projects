"""
Î£ÏÏƒÏ„Î·Î¼Î± Î•Ï€Î¯Î»Ï…ÏƒÎ·Ï‚ RSA Î¼Îµ Coppersmith
Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÎµÏ€Î¹Î»ÏÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± 2.2: Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ m Î±Ï€ÏŒ RSA ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·
ÏŒÏ„Î±Î½ c = (2^500 + m)^3 mod N ÎºÎ±Î¹ m < 2^36
"""

import time

# =============================================================================
# Î’Î‘Î£Î™ÎšÎ•Î£ Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î•Î™Î£ COPPERSMITH
# =============================================================================

def univ_cop(f, N, epsilon):
    """
    ÎœÎ­Î¸Î¿Î´Î¿Ï‚ Coppersmith Î³Î¹Î± ÎµÏÏÎµÏƒÎ· Î¼Î¹ÎºÏÏÎ½ ÏÎ¹Î¶ÏÎ½ Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Ï‰Î½ modulo N
    
    Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹:
    f: Ï„Î¿ Ï€Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿ (Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î²Î±Î¸Î¼Î¿Ï d)
    N: Ï„Î¿ modulus
    epsilon: Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ Î±ÎºÏÎ¯Î²ÎµÎ¹Î±Ï‚ (Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ· Ï„Î¹Î¼Î® = Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Ï€Î»Î­Î³Î¼Î±)
    
    Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹: Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï„Î¹Ï‚ ÏÎ¯Î¶ÎµÏ‚
    """
    R.<x> = QQ[]  # Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ¼Îµ Î´Î±ÎºÏ„ÏÎ»Î¹Î¿ Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Ï‰Î½ Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿Ï…Ï‚ ÏÎ·Ï„Î¿ÏÏ‚
    d = f.degree()
    h = ceil(1/(d*epsilon))
    
    if h == 1:
        return []  # Î§ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Îµ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ h
    
    X = ceil(0.5 * N^(1/d - epsilon))
    n = d * h
    
    # ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î® Ï€Î»Î­Î³Î¼Î±Ï„Î¿Ï‚ Î³Î¹Î± LLL
    L1 = [N^(h-1-j) * (X*x)^i * f(x*X)^j 
          for j in range(0, h) for i in range(0, d)]
    
    # Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·Ï‚ Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï… ÏƒÎµ Î´Î¹Î¬Î½Ï…ÏƒÎ¼Î±
    def map_g(f_poly, n_dim):
        M = vector(ZZ, n_dim)
        coeffs = f_poly.coefficients(sparse=False)
        for i in range(min(len(coeffs), n_dim)):
            M[i] = coeffs[i]
        return M
    
    # Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î¯Î½Î±ÎºÎ± Ï€Î»Î­Î³Î¼Î±Ï„Î¿Ï‚
    M = matrix(n, n, [map_g(L1[i], n) for i in range(n)])
    ML = M.LLL()  # Î•Ï†Î±ÏÎ¼Î¿Î³Î® Î±Î»Î³Î¿ÏÎ¯Î¸Î¼Î¿Ï… LLL
    
    # Î‘Î½Î±ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î® Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï… Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ· LLL
    g = sum(ML[0][i] * x^i / X^i for i in range(n))
    
    return g.roots(multiplicities=False)

# =============================================================================
# ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 1: Î‘Î Î•Î¥Î˜Î•Î™Î‘Î£ COPPERSMITH
# =============================================================================

def lisi_meso_coppersmith():
    """
    Î•Ï€Î¹Î»ÏÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Î¼Îµ Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Coppersmith
    """
    
    print("\n" + "="*70)
    print("ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 1: Î‘Î Î•Î¥Î˜Î•Î™Î‘Î£ Î§Î¡Î—Î£Î— COPPERSMITH")
    print("="*70)
    
    # Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎºÏ†ÏÎ½Î·ÏƒÎ·
    N = 2122840968903324034467344329510307845524745715398875789936591447337206598081
    c = 1792963459690600192400355988468130271248171381827462749870651408943993480816
    max_bits = 36
    
    print(f"N = {N}")
    print(f"c = {c}")
    print(f"Î‘Î½Î±Î¶Î·Ï„Î¿ÏÎ¼Îµ m < 2^{max_bits} = {2**max_bits:,}")
    
    # Î’Î®Î¼Î± 1: Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ 2^500 mod N Î³Î¹Î± Î¼ÎµÎ¯Ï‰ÏƒÎ· ÏƒÏ…Î½Ï„ÎµÎ»ÎµÏƒÏ„ÏÎ½
    vasi = pow(2, 500, N)
    print(f"\n2^500 mod N = {vasi}")
    
    # Î’Î®Î¼Î± 2: ÎŸÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï… f(x) = (Î²Î¬ÏƒÎ· + x)^3 - c mod N
    R.<x> = PolynomialRing(Zmod(N))
    polionimo = (vasi + x)^3 - c
    print(f"\nÎ Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿: f(x) = {polionimo}")
    
    # Î’Î®Î¼Î± 3: ÎŸÏÎ¯Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Î±Î½ÏÏ„Î±Ï„Î¿ ÏŒÏÎ¹Î¿ Î³Î¹Î± Ï„Î¿ m
    X = 2**max_bits  # Î‘Ï†Î¿Ï Î¾Î­ÏÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ m < 2^36
    
    print(f"\nÎ ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± ÎµÏÏÎµÏƒÎ·Ï‚ Î¼Î¹ÎºÏÏÎ½ ÏÎ¹Î¶ÏÎ½ Î¼Îµ X = 2^{max_bits} = {X}")
    print("-" * 50)
    
    # Î”Î¿ÎºÎ¹Î¼Î® Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏÎ½ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ beta ÎºÎ±Î¹ epsilon
    times_beta = [0.1, 0.2, 0.3, 0.4, 0.5]
    times_epsilon = [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1]
    
    for beta in times_beta:
        for epsilon in times_epsilon:
            try:
                print(f"  beta={beta}, epsilon={epsilon}... ", end="")
                rizes = polionimo.small_roots(X=X, beta=beta, epsilon=epsilon)
                if rizes:
                    print(f"Î’Î¡Î•Î˜Î—ÎšÎ‘Î Î¡Î™Î–Î•Î£: {rizes}")
                    for riza in rizes:
                        m = int(riza)
                        if 0 <= m < 2**max_bits:
                            # Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·
                            if pow(vasi + m, 3, N) == c:
                                print(f"\nâœ… Î•Î Î™Î¤Î¥Î§Î™Î‘! m = {m}")
                                print(f"   Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·: (2^500 + m)^3 mod N = {pow(2**500 + m, 3, N)}")
                                print(f"   Î”Î¿ÏƒÎ¼Î­Î½Î¿ c = {c}")
                                return m
                else:
                    print("ÎºÎ±Î¼Î¯Î± ÏÎ¯Î¶Î±")
            except Exception as e:
                print(f"ÏƒÏ†Î¬Î»Î¼Î±: {e}")
    
    # Î”Î¿ÎºÎ¹Î¼Î® Î¼Îµ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ X (ÏƒÎµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Ï„Î¿ m ÎµÎ¯Î½Î±Î¹ ÎµÎ»Î±Ï†ÏÏÏ‚ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿)
    print("\nÎ”Î¿ÎºÎ¹Î¼Î® Î¼Îµ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ X (Î¯ÏƒÏ‰Ï‚ m > 2^36)...")
    for paragonas in [1.1, 1.2, 1.5, 2.0, 5.0]:
        X_megalo = int(2**max_bits * paragonas)
        print(f"\nÎ”Î¿ÎºÎ¹Î¼Î® Î¼Îµ X = {X_megalo} ({paragonas:.1f} * 2^{max_bits})")
        try:
            rizes = polionimo.small_roots(X=X_megalo, beta=0.5, epsilon=0.05)
            if rizes:
                print(f"  Î’ÏÎ­Î¸Î·ÎºÎ±Î½ ÏÎ¯Î¶ÎµÏ‚: {rizes}")
                for riza in rizes:
                    m = int(riza)
                    if 0 <= m < X_megalo:
                        if pow(vasi + m, 3, N) == c:
                            print(f"\nâœ… Î•Î Î™Î¤Î¥Î§Î™Î‘! m = {m}")
                            return m
        except:
            pass
    
    return None

# =============================================================================
# ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 2: Î’Î•Î›Î¤Î™Î£Î¤ÎŸÎ ÎŸÎ™Î—ÎœÎ•ÎÎ— Î•ÎÎ‘ÎÎ¤Î›Î—Î¤Î™ÎšÎ— Î‘ÎÎ‘Î–Î—Î¤Î—Î£Î—
# =============================================================================

def veltistopoiimeni_exantlitiki_anazitisi(N, c, max_bits=36):
    """
    Î•Î¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¼Îµ Î¼Î±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚
    
    Î Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Î¹:
    N: Ï„Î¿ modulus
    c: Ï„Î¿ ciphertext
    max_bits: Î¼Î­Î³Î¹ÏƒÏ„Î¿Ï‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ bits Ï„Î¿Ï… m
    
    Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹: Ï„Î¿ m Î±Î½ Î²ÏÎµÎ¸ÎµÎ¯, Î±Î»Î»Î¹ÏÏ‚ None
    """
    
    print("\n" + "="*70)
    print(f"ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 2: Î’Î•Î›Î¤Î™Î£Î¤ÎŸÎ ÎŸÎ™Î—ÎœÎ•ÎÎ— Î•ÎÎ‘ÎÎ¤Î›Î—Î¤Î™ÎšÎ— Î‘ÎÎ‘Î–Î—Î¤Î—Î£Î— (Î¼Î­Ï‡ÏÎ¹ 2^{max_bits} = {2**max_bits:,})")
    print("="*70)
    
    sinoliko_evros = 2**max_bits
    
    # Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· 1: Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ 2^500 mod N Î¼Î¹Î± Ï†Î¿ÏÎ¬
    vasi = pow(2, 500, N)
    print(f"2^500 mod N = {vasi}")
    
    # Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· 2: ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ modulo Î¼Î¹ÎºÏÏÎ½ Ï€ÏÏÏ„Ï‰Î½
    print("\nÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ modulo Î¼Î¹ÎºÏÏÎ½ Ï€ÏÏÏ„Ï‰Î½ Î³Î¹Î± Î¼ÎµÎ¯Ï‰ÏƒÎ· Ï‡ÏÏÎ¿Ï… Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚:")
    mikroi_protoi = [3, 5, 7, 11, 13, 17, 19]
    
    for p in mikroi_protoi:
        stoxos = c % p
        vasi_mod_p = vasi % p
        
        egkura_ypoloipa = []
        for dokimi in range(p):
            if pow(vasi_mod_p + dokimi, 3, p) == stoxos:
                egkura_ypoloipa.append(dokimi)
        
        if egkura_ypoloipa:
            print(f"  modulo {p}: m â‰¡ {egkura_ypoloipa}")
        else:
            print(f"  modulo {p}: ÎšÎ‘ÎÎ•ÎÎ‘ Î­Î³ÎºÏ…ÏÎ¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ - ÎºÎ¬Ï„Î¹ Ï€Î¬ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚!")
            return None
    
    # Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· 3: ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î¹ÏƒÎ¿Ï„Î¹Î¼Î¯Î±Ï‚ (Î¬ÏÏ„Î¹Î¿Ï‚/Ï€ÎµÏÎ¹Ï„Ï„ÏŒÏ‚)
    isotimia_c = c % 2
    isotimia_vasis = vasi % 2
    print(f"\nÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î¹ÏƒÎ¿Ï„Î¹Î¼Î¯Î±Ï‚: c mod 2 = {isotimia_c}")
    print(f"  Î²Î¬ÏƒÎ· mod 2 = {isotimia_vasis}")
    
    # Î¤Î¿ m Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¹ÎºÎ±Î½Î¿Ï€Î¿Î¹ÎµÎ¯: (Î²Î¬ÏƒÎ· + m)^3 â‰¡ c (mod 2)
    # Î‘Ï€Î»Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ modulo 2: m â‰¡ c + Î²Î¬ÏƒÎ· (mod 2)
    isotimia_m = (isotimia_c + isotimia_vasis) % 2
    print(f"  Î¤Î¿ m Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ {'Î¬ÏÏ„Î¹Î¿' if isotimia_m == 0 else 'Ï€ÎµÏÎ¹Ï„Ï„ÏŒ'}")
    
    # ÎˆÎ½Î±ÏÎ¾Î· ÎµÎ¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ®Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚
    print(f"\nÎ•ÎºÎºÎ¯Î½Î·ÏƒÎ· Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·Ï‚ ÎµÎ¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ®Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚...")
    xronos_enarksis = time.time()
    
    # Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Î²Î®Î¼Î± 2 (Î¼ÏŒÎ½Î¿ Î¬ÏÏ„Î¹Î¿Ï…Ï‚ Î® Î¼ÏŒÎ½Î¿ Ï€ÎµÏÎ¹Ï„Ï„Î¿ÏÏ‚ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚)
    vima = 2
    enarksi = isotimia_m  # 0 Î³Î¹Î± Î¬ÏÏ„Î¹Î¿Ï…Ï‚, 1 Î³Î¹Î± Ï€ÎµÏÎ¹Ï„Ï„Î¿ÏÏ‚
    
    for i in range(enarksi, sinoliko_evros, vima):
        m = i
        
        # Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· Ï€ÏÎ¿ÏŒÎ´Î¿Ï…
        if m % 1000000 == 0 and m > 0:
            xronos_pou_perase = time.time() - xronos_enarksis
            if xronos_pou_perase > 0:
                rythmos = m / xronos_pou_perase
                pososto = float(100 * m / sinoliko_evros)
                print(f"  Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Î·ÎºÎ±Î½ {m:,} Ï„Î¹Î¼Î­Ï‚ ({pososto:.4f}%), {rythmos:.0f} Î´Î¿ÎºÎ¹Î¼Î­Ï‚/Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿")
        
        # ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Î±Ï…Ï„ÏŒ Ï„Î¿ m Î¹ÎºÎ±Î½Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î·Î½ ÎµÎ¾Î¯ÏƒÏ‰ÏƒÎ·
        if pow(vasi + m, 3, N) == c:
            xronos_pou_perase = time.time() - xronos_enarksis
            print(f"\nâœ… Î’Î¡Î•Î˜Î—ÎšÎ• m = {m} Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ {m} Î´Î¿ÎºÎ¹Î¼Î­Ï‚")
            print(f"   Î§ÏÏŒÎ½Î¿Ï‚: {xronos_pou_perase:.2f} Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±")
            print(f"   Î¡Ï…Î¸Î¼ÏŒÏ‚: {m/xronos_pou_perase:.0f} Î´Î¿ÎºÎ¹Î¼Î­Ï‚/Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿")
            return m
    
    print(f"\nÎ‘Î½Î±Î¶Î·Ï„Î®Î¸Î·ÎºÎ±Î½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ {sinoliko_evros:,} Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚, Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î»ÏÏƒÎ·")
    return None

# =============================================================================
# ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 3: ÎœÎ‘Î˜Î—ÎœÎ‘Î¤Î™ÎšÎ— Î Î¡ÎŸÎ£Î•Î“Î“Î™Î£Î—
# =============================================================================

def mathimatiki_proseggisi(N, c, max_bits=36):
    """
    ÎœÎ±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ® Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Î³Î¹Î± ÎµÏ€Î¯Î»Ï…ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚
    """
    
    print("\n" + "="*70)
    print("ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 3: ÎœÎ‘Î˜Î—ÎœÎ‘Î¤Î™ÎšÎ— Î Î¡ÎŸÎ£Î•Î“Î“Î™Î£Î—")
    print("="*70)
    
    # Î“Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ: (2^500 + m)^3 â‰¡ c (mod N)
    # Î‘Î½Î±Ï€Ï„ÏÏƒÏƒÎ¿Ï…Î¼Îµ: (2^500)^3 + 3*(2^500)^2*m + 3*2^500*m^2 + m^3 â‰¡ c (mod N)
    
    A = pow(2, 500, N)
    print(f"A = 2^500 mod N = {A}")
    
    # Î¤Î¿ Ï€Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿ ÎµÎ¯Î½Î±Î¹: m^3 + 3A*m^2 + 3A^2*m + (A^3 - c) â‰¡ 0 (mod N)
    statheros_oros = (pow(A, 3, N) - c) % N
    print(f"Î£Ï„Î±Î¸ÎµÏÏŒÏ‚ ÏŒÏÎ¿Ï‚: A^3 - c mod N = {statheros_oros}")
    
    print("\nÎ‘Î½Î¬Î»Ï…ÏƒÎ· Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚:")
    print(f"Î¤Î¿ m ÎµÎ¯Î½Î±Î¹ < 2^{max_bits} â‰ˆ {2**max_bits:,}")
    print(f"Î¤Î¿ N ÎµÎ¯Î½Î±Î¹ â‰ˆ 2^{N.nbits()} â‰ˆ {N.numerical_approx():.2e}")
    
    # Î˜ÎµÏ‰ÏÎ¯Î± Coppersmith: ÎœÏ€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ ÏÎ¯Î¶ÎµÏ‚ Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎµÏ‚ Î±Ï€ÏŒ N^(1/d)
    # ÏŒÏ€Î¿Ï… d ÎµÎ¯Î½Î±Î¹ Î¿ Î²Î±Î¸Î¼ÏŒÏ‚ Ï„Î¿Ï… Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï… (3 ÏƒÏ„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ® Î¼Î±Ï‚)
    orio_coppersmith = N^(1/3)  # Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î¼Î²Î¿Î»Î¹ÎºÎ® Î­ÎºÏ†ÏÎ±ÏƒÎ·
    orio_coppersmith_float = float(N)^(1/3)  # ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÏƒÎµ float Î³Î¹Î± Î¼Î¿ÏÏ†Î¿Ï€Î¿Î¯Î·ÏƒÎ·
    print(f"\nÎ¤Î¿ Î¸ÎµÏ‰ÏÎ·Ï„Î¹ÎºÏŒ ÏŒÏÎ¹Î¿ Ï„Î¿Ï… Coppersmith Î³Î¹Î± ÏÎ¯Î¶ÎµÏ‚ ÎµÎ¯Î½Î±Î¹: N^(1/3) â‰ˆ {orio_coppersmith_float:.2e}")
    print(f"Î¤Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ ÏŒÏÎ¹Î¿ Î¼Î±Ï‚ ÎµÎ¯Î½Î±Î¹: 2^{max_bits} = {2**max_bits:,}")
    
    # Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï€Î¿ÏƒÎ¿ÏƒÏ„Î¿Ï
    pososto = (2**max_bits) / orio_coppersmith_float
    print(f"Î£ÏÎ³ÎºÏÎ¹ÏƒÎ·: {pososto:.2%} Ï„Î¿Ï… Î¿ÏÎ¯Î¿Ï… Coppersmith")
    
    return None

# =============================================================================
# ÎšÎ¥Î¡Î™ÎŸ Î£Î¥Î£Î¤Î—ÎœÎ‘ Î•Î Î™Î›Î¥Î£Î—Î£
# =============================================================================

def kyrio_sistima_epilysis():
    """
    ÎšÏÏÎ¹Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÎµÏ€Î¯Î»Ï…ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚
    """
    
    print("\n" + "="*70)
    print("Î£Î¥Î£Î¤Î—ÎœÎ‘ Î•Î Î™Î›Î¥Î£Î—Î£ RSA ÎœÎ• Î§Î¡Î—Î£Î— COPPERSMITH")
    print("="*70)
    
    # Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚
    N = 2122840968903324034467344329510307845524745715398875789936591447337206598081
    c = 1792963459690600192400355988468130271248171381827462749870651408943993480816
    max_bits = 36
    
    print(f"Modulus N (251 bits) = {N}")
    print(f"Ciphertext c = {c}")
    print(f"Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± m < 2^{max_bits} = {2**max_bits:,}")
    
    lisi = None
    
    # ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 1: Î‘Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Coppersmith
    print("\n" + "="*70)
    print("Î Î¡Î©Î¤Î— Î Î¡ÎŸÎ£Î Î‘Î˜Î•Î™Î‘: Î‘Î Î•Î¥Î˜Î•Î™Î‘Î£ COPPERSMITH")
    print("="*70)
    
    lisi = lisi_meso_coppersmith()
    if lisi:
        print(f"\nâœ… Î’ÏÎ­Î¸Î·ÎºÎµ Î»ÏÏƒÎ· Î¼Îµ Coppersmith: m = {lisi}")
        print(f"   Î”ÎµÎºÎ±ÎµÎ¾Î±Î´Î¹ÎºÎ® Î¼Î¿ÏÏ†Î®: {hex(lisi)}")
        print(f"   Î”Ï…Î±Î´Î¹ÎºÎ® Î¼Î¿ÏÏ†Î®: {bin(lisi)}")
        return lisi
    
    # ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 2: ÎœÎ±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·
    print("\n" + "="*70)
    print("Î”Î•Î¥Î¤Î•Î¡Î— Î Î¡ÎŸÎ£Î Î‘Î˜Î•Î™Î‘: ÎœÎ‘Î˜Î—ÎœÎ‘Î¤Î™ÎšÎ— Î‘ÎÎ‘Î›Î¥Î£Î—")
    print("="*70)
    
    mathimatiki_proseggisi(N, c, max_bits)
    
    # ÎœÎ•Î˜ÎŸÎ”ÎŸÎ£ 3: Î•Î¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· (Î¼ÏŒÎ½Î¿ Î¼Îµ Î¬Î´ÎµÎ¹Î± Ï‡ÏÎ®ÏƒÏ„Î·)
    print("\n" + "="*70)
    print("Î¤Î¡Î™Î¤Î— Î Î¡ÎŸÎ£Î Î‘Î˜Î•Î™Î‘: Î•ÎÎ‘ÎÎ¤Î›Î—Î¤Î™ÎšÎ— Î‘ÎÎ‘Î–Î—Î¤Î—Î£Î—")
    print("="*70)
    
    proeidopoiisi = f"""
    Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î•Î¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· 2^{max_bits} = {2**max_bits:,} Î´Ï…Î½Î±Ï„Î¿Ï„Î®Ï„Ï‰Î½.
    
    Î£Îµ Î­Î½Î±Î½ Ï„Ï…Ï€Î¹ÎºÏŒ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® Î¼Îµ Î±Ï€ÏŒÎ´Î¿ÏƒÎ· 1 ÎµÎºÎ±Ï„Î¿Î¼Î¼ÏÏÎ¹Î¿ Î´Î¿ÎºÎ¹Î¼ÏÎ½/Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î¿:
      Î•ÎºÏ„Î¹Î¼ÏÎ¼ÎµÎ½Î¿Ï‚ Ï‡ÏÏŒÎ½Î¿Ï‚: {2**max_bits / 1e6 / 3600:.1f} ÏÏÎµÏ‚
    
    Î˜Î­Î»ÎµÏ„Îµ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ; (Î½/Î¿): """
    
    print(proeidopoiisi)
    apantisi = input().strip().lower()
    
    if apantisi == 'Î½' or apantisi == 'yes' or apantisi == 'y':
        lisi = veltistopoiimeni_exantlitiki_anazitisi(N, c, max_bits)
        if lisi:
            print(f"\nâœ… Î’ÏÎ­Î¸Î·ÎºÎµ Î»ÏÏƒÎ· Î¼Îµ ÎµÎ¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·: m = {lisi}")
            print(f"   Î”ÎµÎºÎ±ÎµÎ¾Î±Î´Î¹ÎºÎ® Î¼Î¿ÏÏ†Î®: {hex(lisi)}")
            print(f"   Î”Ï…Î±Î´Î¹ÎºÎ® Î¼Î¿ÏÏ†Î®: {bin(lisi)}")
            return lisi
    else:
        print("Î Î±ÏÎ¬Î»ÎµÎ¹ÏˆÎ· ÎµÎ¾Î±Î½Ï„Î»Î·Ï„Î¹ÎºÎ®Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚.")
    
    # Î¤Î•Î›Î™ÎšÎ— Î Î¡ÎŸÎ£Î Î‘Î˜Î•Î™Î‘: Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ Ï€Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿ Î³Î¹Î± Coppersmith
    print("\n" + "="*70)
    print("Î¤Î•Î›Î™ÎšÎ— Î Î¡ÎŸÎ£Î Î‘Î˜Î•Î™Î‘: Î•ÎÎ‘Î›Î›Î‘ÎšÎ¤Î™ÎšÎŸ Î ÎŸÎ›Î¥Î©ÎÎ¥ÎœÎŸ COPPERSMITH")
    print("="*70)
    
    # Î”Î¿ÎºÎ¹Î¼Î® Î¼Îµ ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ® Î¼Î¿ÏÏ†Î® Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï…
    R.<x> = PolynomialRing(Zmod(N))
    
    # Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï„Ï‰Î½ 2^500, 2^1000, 2^1500 modulo N
    duo_500_mod_N = pow(2, 500, N)
    duo_1000_mod_N = pow(2, 1000, N)
    duo_1500_mod_N = pow(2, 1500, N)
    
    enallaktiko_polionimo = x^3 + 3*duo_500_mod_N*x^2 + 3*duo_1000_mod_N*x + (duo_1500_mod_N - c)
    print(f"Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ Ï€Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿: {enallaktiko_polionimo}")
    
    X = 2**max_bits
    print(f"\nÎ”Î¿ÎºÎ¹Î¼Î® small_roots Î¼Îµ X = {X}")
    
    try:
        rizes = enallaktiko_polionimo.small_roots(X=X, beta=0.5, epsilon=0.05)
        if rizes:
            print(f"Î’ÏÎ­Î¸Î·ÎºÎ±Î½ ÏÎ¯Î¶ÎµÏ‚: {rizes}")
            for riza in rizes:
                m = int(riza)
                if 0 <= m < 2**max_bits:
                    if pow(2**500 + m, 3, N) == c:
                        print(f"\nâœ… Î•Î Î™Î¤Î¥Î§Î™Î‘! m = {m}")
                        return m
    except Exception as e:
        print(f"Î£Ï†Î¬Î»Î¼Î±: {e}")
    
    print("\nâŒ Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î»ÏÏƒÎ· Î¼Îµ ÎºÎ±Î¼Î¯Î± Î¼Î­Î¸Î¿Î´Î¿.")
        
    return None

# =============================================================================
# Î•ÎšÎšÎ™ÎÎ—Î£Î— Î£Î¥Î£Î¤Î—ÎœÎ‘Î¤ÎŸÎ£
# =============================================================================

if __name__ == "__main__":
    xronos_enarksis = time.time()
    
    try:
        # Î†Î¼ÎµÏƒÎ· Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± ÎµÏ€Î¯Î»Ï…ÏƒÎ·Ï‚
        print("\n" + "="*70)
        print("Î‘ÎœÎ•Î£Î— Î•Î Î™Î›Î¥Î£Î— ÎœÎ• COPPERSMITH")
        print("="*70)
        
        N = 2122840968903324034467344329510307845524745715398875789936591447337206598081
        c = 1792963459690600192400355988468130271248171381827462749870651408943993480816
        
        # Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î¿Î»Ï…Ï‰Î½ÏÎ¼Î¿Ï…
        R.<x> = PolynomialRing(Zmod(N))
        base = pow(2, 500, N)
        f = (base + x)^3 - c
        
        print(f"2^500 mod N = {base}")
        print(f"Î Î¿Î»Ï…ÏÎ½Ï…Î¼Î¿: f(x) = {f}")
        
        # Î”Î¿ÎºÎ¹Î¼Î® small_roots Î¼Îµ Î²Î­Î»Ï„Î¹ÏƒÏ„ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚
        X = 2**36
        print(f"\nÎ”Î¿ÎºÎ¹Î¼Î® small_roots Î¼Îµ X = 2^36 = {X:,}")
        
        # Î ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Î¼Îµ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚
        for beta in [0.4, 0.5, 0.6]:
            for epsilon in [0.01, 0.02, 0.03, 0.04, 0.05]:
                print(f"\n  beta={beta}, epsilon={epsilon}... ", end="")
                try:
                    rizes = f.small_roots(X=X, beta=beta, epsilon=epsilon)
                    if rizes:
                        print(f"Î’ÏÎ­Î¸Î·ÎºÎ±Î½ ÏÎ¯Î¶ÎµÏ‚: {rizes}")
                        for riza in rizes:
                            m = int(riza)
                            if 0 <= m < X:
                                # Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·
                                if pow(2**500 + m, 3, N) == c:
                                    print(f"\nğŸ‰ Î’Î¡Î•Î˜Î—ÎšÎ• Î— Î›Î¥Î£Î—: m = {m}")
                                    print(f"   Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·: (2^500 + {m})^3 mod N = {pow(2**500 + m, 3, N)}")
                                    print(f"   Î”Î¿ÏƒÎ¼Î­Î½Î¿ c = {c}")
                                    print(f"   Î”ÎµÎºÎ±ÎµÎ¾Î±Î´Î¹ÎºÎ¬: {hex(m)}")
                                    print(f"   Î”Ï…Î±Î´Î¹ÎºÎ¬: {bin(m)}")
                                    print(f"   ÎœÎ®ÎºÎ¿Ï‚: {m.bit_length()} bits")
                                    print(f"\nÎ£Ï…Î½Î¿Î»Î¹ÎºÏŒÏ‚ Ï‡ÏÏŒÎ½Î¿Ï‚: {time.time() - xronos_enarksis:.2f} Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±")
                                    exit(0)
                    else:
                        print("ÎºÎ±Î¼Î¯Î± ÏÎ¯Î¶Î±")
                except Exception as e:
                    print(f"ÏƒÏ†Î¬Î»Î¼Î±: {e}")
        
        print("\nÎ— Î¬Î¼ÎµÏƒÎ· Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Î´ÎµÎ½ Î²ÏÎ®ÎºÎµ Î»ÏÏƒÎ·.")
        print("Î•ÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î¿Ï… Ï€Î»Î®ÏÎ¿Ï…Ï‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ ÎµÏ€Î¯Î»Ï…ÏƒÎ·Ï‚...")
        
        # Î•ÎºÏ„Î­Î»ÎµÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚
        lisi = kyrio_sistima_epilysis()
        
        if lisi is not None:
            print("\n" + "="*70)
            print("Î¤Î•Î›Î™ÎšÎ— Î•Î Î‘Î›Î—Î˜Î•Î¥Î£Î—")
            print("="*70)
            
            # Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î¿Ï‚ Î³Î¹Î± ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·
            N = 2122840968903324034467344329510307845524745715398875789936591447337206598081
            c = 1792963459690600192400355988468130271248171381827462749870651408943993480816
            
            # Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·
            aristero_melos = pow(2**500 + lisi, 3, N)
            print(f"(2^500 + m)^3 mod N = {aristero_melos}")
            print(f"Î”Î¿ÏƒÎ¼Î­Î½Î¿ c = {c}")
            print(f"Î‘Î½Ï„Î¹ÏƒÏ„Î¿Î¹Ï‡Î¯Î±: {aristero_melos == c}")
            
            print(f"\nÎ£Ï…Î½Î¿Î»Î¹ÎºÏŒÏ‚ Ï‡ÏÏŒÎ½Î¿Ï‚: {time.time() - xronos_enarksis:.2f} Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±")
            print("="*70)
            
            print(f"\nğŸ“Š Î‘Î ÎŸÎ¤Î•Î›Î•Î£ÎœÎ‘Î¤Î‘:")
            print(f"   ÎœÎ®Î½Ï…Î¼Î± m = {lisi}")
            print(f"   Î”ÎµÎºÎ±ÎµÎ¾Î±Î´Î¹ÎºÎ¬: {hex(lisi)}")
            print(f"   Î”Ï…Î±Î´Î¹ÎºÎ¬: {bin(lisi)}")
            print(f"   ÎœÎ®ÎºÎ¿Ï‚ ÏƒÎµ bits: {lisi.bit_length()}")
            print(f"   Î•Ï€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·: {(pow(2**500 + lisi, 3, N) == c)}")
        else:
            print("\nÎ”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î»ÏÏƒÎ·.")
            
    except KeyboardInterrupt:
        print("\n\nÎ¤Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î¹Î±ÎºÏŒÏ€Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·.")
    except Exception as e:
        print(f"\nÎ£Ï†Î¬Î»Î¼Î±: {e}")
        import traceback
        traceback.print_exc()

